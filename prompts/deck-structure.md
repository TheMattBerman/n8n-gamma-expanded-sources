# Gamma Deck Structure Spec

This document defines the prompt structure for the Gamma API to generate the competitive intelligence deck.

## Gamma API Overview

This workflow uses Gamma's **Create from Template API** (Remix) to generate presentations. This allows you to:
- Design a beautiful template once in Gamma's UI
- Programmatically fill it with new competitor data
- Maintain consistent branding and visual design

## API Endpoint

```
POST https://public-api.gamma.app/v1.0/generations/from-template
```

## Request Headers

```
X-API-KEY: sk-gamma-xxxxxxxx
Content-Type: application/json
```

## Request Body Structure

```json
{
  "gammaId": "YOUR_TEMPLATE_ID_HERE",
  "prompt": "{{formatted_competitor_analysis}}",
  "themeId": "optional - defaults to template theme",
  "exportAs": "pdf or pptx (optional)"
}
```

## Getting Your Template ID

1. Create your template deck in Gamma's UI (gamma.app)
2. Design it with your branding, colors, and layout
3. Copy the deck ID from the URL: `gamma.app/docs/YOUR_TEMPLATE_ID`
4. Replace `YOUR_TEMPLATE_ID_HERE` in the workflow

## Custom Outline Template

This is the prompt that tells Gamma exactly what slides to create. Insert data from the Claude analysis JSON.

```
Create a competitive intelligence deck analyzing {{company_name}} ({{company_url}}).

SLIDE 1: COVER
Title: "{{company_name}} Playbook"
Subtitle: "Competitive Intelligence Report"
Include: Analysis date: {{analysis_date}}
Style: Bold, attention-grabbing

SLIDE 2: EXECUTIVE SUMMARY
Title: "Key Insights"
Content:
- Threat Level: {{threat_level}}
- {{one_liner}}
Key Insights (bullet list):
{{#each key_insights}}
- {{this}}
{{/each}}
Style: Clean, scannable bullets

SLIDE 3: POSITIONING ANALYSIS
Title: "How They Position"
Content sections:
VALUE PROPOSITION: {{value_proposition}}
TARGET AUDIENCE: {{target_audience}}
KEY DIFFERENTIATORS:
{{#each key_differentiators}}
- {{this}}
{{/each}}
MARKET POSITION: {{market_position}}
Include a positioning statement quote: "{{positioning_statement}}"
Style: Strategic, analytical

SLIDE 4: MESSAGING BREAKDOWN
Title: "Their Messaging Playbook"
Content sections:
BRAND VOICE: {{brand_voice}}
PRIMARY HOOKS:
{{#each primary_hooks}}
- "{{hook}}" ({{type}}) - {{effectiveness}}
{{/each}}
KEY PHRASES: {{key_phrases}}
PROOF ELEMENTS: {{proof_elements}}
Style: Quote examples prominently

SLIDE 5: CONTENT & SOCIAL STRATEGY
Title: "Content Machine Analysis"
Content sections:
CONTENT PILLARS: {{content_pillars}}
FORMATS: {{formats_used}}
PUBLISHING FREQUENCY: {{publishing_frequency}}
SOCIAL METRICS:
- LinkedIn Followers: {{social_metrics.linkedin_followers}}
- Instagram Followers: {{social_metrics.instagram_followers}}
- Posting Frequency: {{social_metrics.posting_frequency}}
TOP PERFORMING CONTENT:
{{#each top_performing_content}}
- {{title}} ({{format}}) - {{why_it_works}}
{{/each}}
DISTRIBUTION: {{distribution_channels}}
Style: Data-focused with clear categories

SLIDE 6: AD PSYCHOLOGY BREAKDOWN
Title: "Stealing Their Ad Playbook"
Content sections:
AD ACTIVITY: {{ad_volume}}
AD TYPES: {{primary_ad_types}}
HOOK PATTERNS:
{{#each hook_patterns}}
- {{pattern}}: "{{example}}" → Triggers: {{psychological_trigger}}
{{/each}}
VISUAL STYLE: {{visual_style}}
CTA PATTERNS: {{cta_patterns}}
Style: Include visual examples if possible, psychology-focused

SLIDE 7: SEO INTELLIGENCE
Title: "Search Performance"
Content sections:
ESTIMATED TRAFFIC: {{seo_intelligence.estimated_traffic}}
ORGANIC KEYWORDS: {{seo_intelligence.organic_keywords}}
TRAFFIC VALUE: {{seo_intelligence.estimated_traffic_value}}
TOP OPPORTUNITIES:
{{#each seo_intelligence.top_opportunities}}
- {{this}}
{{/each}}
Style: Data-focused with key metrics prominent

SLIDE 8: GAPS & OPPORTUNITIES
Title: "Where They're Vulnerable"
Content sections:
CONTENT GAPS:
{{#each content_gaps}}
- Gap: {{gap}} → Your Play: {{opportunity}}
{{/each}}
MESSAGING GAPS:
{{#each messaging_gaps}}
- Gap: {{gap}} → Your Play: {{opportunity}}
{{/each}}
AUDIENCE GAPS:
{{#each audience_gaps}}
- Gap: {{gap}} → Your Play: {{opportunity}}
{{/each}}
Style: Two-column format (Gap | Opportunity)

SLIDE 9: HOW TO BEAT THEM
Title: "Your Attack Plan"
Content sections:
QUICK WINS (DO THIS WEEK):
{{#each quick_wins}}
- {{tactic}} ({{effort}} effort) - {{why}}
{{/each}}
POSITIONING PLAYS:
{{#each positioning_plays}}
- {{play}}: {{execution}}
{{/each}}
CONTENT TO STEAL:
{{#each content_to_steal}}
- {{what}} → Your angle: {{your_angle}}
{{/each}}
AD IDEAS:
{{#each ad_ideas}}
- {{concept}}: Hook: "{{hook}}"
{{/each}}
Style: Action-oriented, checklist format

SLIDE 10: NEXT STEPS
Title: "Ready to Win?"
Content:
- This analysis was generated by AI in under 60 seconds
- Want us to run this on YOUR competitors?
- Book a call: [INSERT YOUR LINK]
Include CTA button or link
Style: Bold CTA, minimal text
```

## n8n Implementation

### Step 1: Parse Claude's JSON Response

Use a Code node to extract and validate the JSON:

```javascript
// Parse Claude's response
const claudeResponse = $input.first().json;
const content = claudeResponse.content[0].text;

// Extract JSON from response
let analysis;
try {
  analysis = JSON.parse(content);
} catch (e) {
  // Try to extract JSON if wrapped in markdown
  const jsonMatch = content.match(/\{[\s\S]*\}/);
  if (jsonMatch) {
    analysis = JSON.parse(jsonMatch[0]);
  } else {
    throw new Error('Could not parse Claude response as JSON');
  }
}

return { json: analysis };
```

### Step 2: Format Outline for Gamma

Use another Code node to build the Gamma prompt:

```javascript
const analysis = $input.first().json;

// Helper to format arrays as bullet lists
const formatList = (arr) => arr.map(item => `- ${typeof item === 'object' ? JSON.stringify(item) : item}`).join('\n');

const gammaPrompt = `
Create a competitive intelligence deck analyzing ${analysis.company_name} (${analysis.company_url}).

## SLIDE 1: COVER
Title: "${analysis.company_name} Playbook"
Subtitle: "Competitive Intelligence Report"
Date: ${analysis.analysis_date}

## SLIDE 2: EXECUTIVE SUMMARY
Threat Level: ${analysis.executive_summary.threat_level}
${analysis.executive_summary.one_liner}

Key Insights:
${formatList(analysis.executive_summary.key_insights)}

## SLIDE 3: POSITIONING
Value Proposition: ${analysis.positioning.value_proposition}
Target Audience: ${analysis.positioning.target_audience}
Market Position: ${analysis.positioning.market_position}

Differentiators:
${formatList(analysis.positioning.key_differentiators)}

## SLIDE 4: MESSAGING
Brand Voice: ${analysis.messaging.brand_voice}

Key Hooks:
${analysis.messaging.primary_hooks.map(h => `- "${h.hook}" (${h.type})`).join('\n')}

Proof Elements:
${formatList(analysis.messaging.proof_elements)}

## SLIDE 5: CONTENT & SOCIAL STRATEGY
Pillars: ${analysis.content_strategy.content_pillars.join(', ')}
Formats: ${analysis.content_strategy.formats_used.join(', ')}
Frequency: ${analysis.content_strategy.publishing_frequency}

Social Metrics:
- LinkedIn Followers: ${analysis.content_strategy.social_metrics?.linkedin_followers || 'N/A'}
- Instagram Followers: ${analysis.content_strategy.social_metrics?.instagram_followers || 'N/A'}

Top Content:
${analysis.content_strategy.top_performing_content.map(c => `- ${c.title} (${c.format})`).join('\n')}

## SLIDE 6: AD PSYCHOLOGY
Volume: ${analysis.ad_psychology.ad_volume}
Types: ${analysis.ad_psychology.primary_ad_types.join(', ')}
Visual Style: ${analysis.ad_psychology.visual_style}

Hook Patterns:
${analysis.ad_psychology.hook_patterns.map(p => `- ${p.pattern}: "${p.example}"`).join('\n')}

## SLIDE 7: SEO INTELLIGENCE
Estimated Traffic: ${analysis.seo_intelligence?.estimated_traffic || 'N/A'}
Organic Keywords: ${analysis.seo_intelligence?.organic_keywords || 'N/A'}
Traffic Value: ${analysis.seo_intelligence?.estimated_traffic_value || 'N/A'}

Top Opportunities:
${(analysis.seo_intelligence?.top_opportunities || []).map(o => `- ${o}`).join('\n')}

## SLIDE 8: GAPS & OPPORTUNITIES
Content Gaps:
${analysis.gaps_and_opportunities.content_gaps.map(g => `- ${g.gap} → ${g.opportunity}`).join('\n')}

Messaging Gaps:
${analysis.gaps_and_opportunities.messaging_gaps.map(g => `- ${g.gap} → ${g.opportunity}`).join('\n')}

## SLIDE 9: HOW TO BEAT THEM
Quick Wins:
${analysis.how_to_beat_them.quick_wins.map(w => `- ${w.tactic} (${w.effort})`).join('\n')}

Positioning Plays:
${analysis.how_to_beat_them.positioning_plays.map(p => `- ${p.play}`).join('\n')}

Ad Ideas:
${analysis.how_to_beat_them.ad_ideas.map(a => `- ${a.concept}: "${a.hook}"`).join('\n')}

## SLIDE 10: CTA
"Want us to analyze YOUR competitors?"
Book a strategy call: [YOUR_LINK]
`.trim();

return {
  json: {
    prompt: gammaPrompt,
    company_name: analysis.company_name,
    analysis: analysis
  }
};
```

### Step 3: Call Gamma Remix API

HTTP Request node configuration:

```json
{
  "method": "POST",
  "url": "https://public-api.gamma.app/v1.0/generations/from-template",
  "headers": {
    "X-API-KEY": "={{$credentials.gammaApi.apiKey}}",
    "Content-Type": "application/json"
  },
  "body": {
    "gammaId": "YOUR_TEMPLATE_ID_HERE",
    "prompt": "={{$json.prompt}}"
  }
}
```

### Step 4: Poll for Completion

The Gamma API is async. Poll the status endpoint:

**Endpoint:** `GET https://public-api.gamma.app/v1.0/generations/{generationId}`

```javascript
// Check generation status
const generationId = $input.first().json.generationId;
const status = $input.first().json.status;

if (status === 'completed') {
  return {
    json: {
      deck_url: $input.first().json.gammaUrl,
      generation_id: generationId,
      credits_used: $input.first().json.credits?.deducted,
      status: 'completed'
    }
  };
} else if (status === 'failed') {
  throw new Error('Gamma generation failed');
} else {
  // Still processing - continue polling
  return { json: { status: 'processing', generationId: generationId } };
}
```

## Output

The final output should include:
- `deck_url`: The shareable Gamma deck link (`gammaUrl` from API)
- `generation_id`: For future reference
- `credits_used`: API credits consumed
- `credits_remaining`: Remaining API credits

## Theme Recommendations

For the competitive intelligence deck, recommend these Gamma settings:
- **Theme**: Dark mode or "Midnight" for executive feel
- **Image Style**: "Modern" or "Abstract"
- **Font**: Clean sans-serif (default is fine)
- **Colors**: Professional blues/grays or your brand colors

## Export Options

Remind users they can:
- Share the Gamma link directly
- Export to PDF for email attachments
- Export to PPTX for customization
- Embed on websites
